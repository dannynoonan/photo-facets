{% extends 'manage.html' %}

{% block body %}

{% if mediaitem %}
<p></p>
<img src="{{ mediaitem.thumb_url }}"/>
<!-- <div id="miniGmap"></div> -->

<form action="/lockdownsf/manage/mediaitem_edit/" method="POST">
    {% csrf_token %}
    <input type="hidden" name="media-item-external-id" value="{{ mediaitem.external_id }}">
<table class="table table-hover table-fit">
    <tbody>
        <tr><th scope="row">External id:</th>
            <td><a href="https://photos.google.com/lr/album/{{ mediaitem.album.external_id }}/photo/{{ mediaitem.external_id }}" target="new">
                    {{ mediaitem.external_id }}</a></td></tr>
        <tr><th scope="row">File name:</th>
            <td>{{ mediaitem.file_name }}</td></tr>
        <tr><th scope="row">Album:</th>
            <td>{{ mediaitem.album.name }}</td></tr>
            <tr><th scope="row">Description:</th>
            <td>{{ mediaitem.description }}</td></tr>
        <tr><th scope="row">Date taken:</th>
            <td>{{ mediaitem.dt_taken }}</td></tr>
        <tr><th scope="row">File format:</th>
            <td>{{ mediaitem.mime_type }}</td></tr>
        <tr><th scope="row">Latitude:</th>
            <td>{{ mediaitem.latitude }}</td></tr>
        <tr><th scope="row">Longitude:</th>
            <td>{{ mediaitem.longitude }}</td></tr>
        <tr><th scope="row">Dimensions:</th>
            <td>{{ mediaitem.width }} x {{ mediaitem.height }}</td></tr>
        <tr><th scope="row">Album:</th>
            <td>{{ mediaitem.album.name }}</td></tr>
        <!-- <tr><th scope="row">Tags:</th>
            <td>{{ display_tags }}</td></tr> -->
        <tr><th scope="row">Tags:</th>
            <td id="tag-display-cell">
                <div id="tag-display" onclick="makeTagsEditable()">
                {% if display_tags %}
                <ul>
                    {% for display_tag in display_tags %}
                    <li>{{ display_tag.name }}</li>
                    {% endfor %}
                </ul>
                {% else %}
                [+]
                {% endif %}
                </div></td>
            <td id="tag-checkbox-cell" class="hidden-block">
            {% for tag in all_tags %}
            <div class="form-group custom-control custom-checkbox">
                <input type="checkbox" id="tag-{{ tag.id }}" class="custom-control-input" name="tag_ids" value="{{ tag.id }}"
                {% if tag in display_tags %} checked="" {% endif %}>
                <label class="custom-control-label" for="tag-{{ tag.id }}">{{ tag.name }}</label>
            </div>
            {% endfor %} 
            </td>
        </tr>
        <tr><th scope="row">Extracted text:</th>
            <td>{{ mediaitem.extracted_text }}</td></tr>
        <tr><th scope="row">Status:</th>
            <td>{{ mediaitem.status }}</td></tr>
        <tr><td id="submit-cell" class="hidden-block" colspan="2">
                <input id="submit-buttom" type="submit" value="Update"></td></tr>
    </tbody>
</table>
</form>


{% else %}
<div class="alert alert-warning">
    <h5>No mediaitem found matching external_id <strong>{{ mediaitem_external_id }}</strong></h5>
</div>
{% endif %}

{% if exception %}
<div class="alert alert-danger">
    <h5><strong>Exception:</strong> {{ exception }}</h5>
    <p>Data dump: {{ dump }}</p>
</div>
{% endif %}

{% endblock %}